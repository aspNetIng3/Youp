<!-- TODO : Intégrer le topic -->
@{
     int countMessage = 0;
}
<div id="content">
    <div>
        <h2>Sujet : @ViewBag.Thread.Data.Title</h2>
        <h3 class="most-recent">Les derniers messages</h3>
        <hr />
        

        <div id="conversation" style="overflow-y:auto; height:500px;">
            @foreach (YoupRepository.Model.MessagePOCO key in (ViewBag.Messages as IEnumerable<YoupRepository.Model.MessagePOCO>))
            {
                
                 countMessage++;
                 if ( countMessage%2 == 0) { /* pair : right */
                        <div class="row">
                            <div class="col-md-10 right">
                                <div class="masthead col-md-12">
                                    <p>
                                        <span class="title">@key.Data.Title</span>
                                        <span class="create">Crée par @key.Data.UserId le @key.Data.CreatedAt</span>
                                    </p>
                                </div>
                                <div class="subhead col-md-12">
                                    <p>@key.Data.Content</p>
                                </div>
                            </div>
                            <div class="col-md-2" id="profil">
                                <img class="profil" src="http://www.almostsavvy.com/wp-content/uploads/2011/04/profile-photo.jpg" alt="Profil picture" />
                            </div>
                        </div>
                 } else { /* impair :  left */
                     <div class="row">
                        <div class="col-md-2" id="profil">
                            <img class="profil" src="http://www.almostsavvy.com/wp-content/uploads/2011/04/profile-photo.jpg" alt="Profil picture" />
                        </div>
                        <div class="col-md-10 left">
                            <div class="masthead col-md-12">
                                <p>
                                    <span class="title">@key.Data.Title</span>
                                    <span class="create" >Crée par @key.Data.UserId le @key.Data.CreatedAt</span>
                                </p>
                            </div>
                            <div class="subhead col-md-12">
                                <p>@key.Data.Content</p>
                            </div>
                        </div>
                    </div>
                 }
            }   
        </div>

        <div style="clear:both;"></div>
        <div id="form-create">
           @using (Html.BeginForm("Create", "Message", null, FormMethod.Post, new { id = "message-form" }))
            {
                    <form> 
                        <div class="row form-group">
                            <div class="col-xs-6 col-md-offset-1">
                                <input class="form-control" type="text" name="Title" placeholder="Titre">
                            </div>
                        </div>
                        <div class="row form-group">
                            <div class="col-xs-10 col-md-offset-1">
                                <textarea class="form-control" rows="5" name="Content" placeholder="Contenu"></textarea>
                            </div>
                        </div>
                        <div class="row form-group">
               <input type="hidden" name="Thread" value="@ViewBag.Thread.Data.Id" />
                            <input type="hidden" name="User" value="1" />

                            <div class="col-xs-10 col-md-offset-1">
                                <button id="submit" type="submit" class="btn btn-default pull-right btn-success">Publier le message</button>
                            </div>
                        </div>
                   </form>
            }
        </div>
    </div>
</div>
